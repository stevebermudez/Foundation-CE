import { db } from "./db";
import { practiceExams, examQuestions } from "@shared/schema";
import { eq, and } from "drizzle-orm";

// Form A questions (100 questions from the primary final exam document)
const formAQuestions = [
  { questionText: "A real estate professional who leases, maintains, and operates income‑producing property for owners is a:", options: ["Sales associate", "Property manager", "Business broker", "Developer"], correctAnswer: "B", explanation: "Property managers handle operations, budgeting, rent collection, and maintenance to protect the owner's investment and maximize income.", unitReference: "1.3" },
  { questionText: "A practitioner who handles the sale and leasing of office buildings and retail centers works in:", options: ["Residential sales", "Industrial sales", "Commercial real estate", "Agricultural sales"], correctAnswer: "C", explanation: "Commercial real estate includes income‑producing properties such as retail, office, hotels, and shopping centers.", unitReference: "1.2" },
  { questionText: "A Florida real estate license is required when a person:", options: ["Sells their own property", "Advertises their own home", "Performs real estate services for another for compensation", "Collects rent on their own property"], correctAnswer: "C", explanation: "A license is required when someone performs real estate services for another party and for compensation.", unitReference: "2.1" },
  { questionText: "Working with a builder to sell newly constructed homes in a subdivision is an example of:", options: ["Business brokerage", "Industrial sales", "Property management", "Residential tract sales"], correctAnswer: "D", explanation: "Residential tract sales involve working directly with developers to sell large numbers of new homes.", unitReference: "1.2" },
  { questionText: "The primary goal of property management is to:", options: ["Maximize gross rent", "Reduce expenses to zero", "Protect the owner's investment and maximize net income", "Ensure long‑term tenants regardless of profitability"], correctAnswer: "C", explanation: "Property managers balance income and expenses to maintain or improve property value.", unitReference: "1.3" },
  { questionText: "Which industry is NOT directly related to real estate?", options: ["Appraisal", "Mortgage lending", "Securities underwriting", "Property inspection"], correctAnswer: "C", explanation: "Securities underwriting pertains to stocks and bonds, unrelated to real estate practice.", unitReference: "1.1" },
  { questionText: "Business brokers assist with the sale of:", options: ["Vacant land", "Residential homes", "Going‑concern businesses", "Industrial warehouses"], correctAnswer: "C", explanation: "Business brokerage involves selling operational businesses, sometimes including real property.", unitReference: "1.2" },
  { questionText: "Industrial real estate includes:", options: ["Shopping centers", "Office buildings", "Factories and distribution facilities", "Condominiums"], correctAnswer: "C", explanation: "Industrial properties are used for manufacturing, logistics, or warehousing.", unitReference: "1.2" },
  { questionText: "A Florida sales associate must work under the supervision of:", options: ["A title company", "No one", "A licensed broker or owner‑developer", "A lender"], correctAnswer: "C", explanation: "Sales associates cannot work independently; they must operate through a broker.", unitReference: "2.3" },
  { questionText: "Selling farms, groves, and ranches is part of which specialization?", options: ["Commercial real estate", "Industrial real estate", "Agricultural real estate", "Business brokerage"], correctAnswer: "C", explanation: "Agricultural real estate deals with large tracts used for production.", unitReference: "1.2" },
  { questionText: "Which agency regulates and licenses Florida real estate professionals?", options: ["FREC", "HUD", "DBPR", "CFPB"], correctAnswer: "C", explanation: "The Department of Business and Professional Regulation oversees licensing for all professions, including real estate.", unitReference: "2.2" },
  { questionText: "FREC is responsible for:", options: ["Issuing loans", "Federal enforcement", "Administering and enforcing Chapter 475", "Determining commission rates"], correctAnswer: "C", explanation: "FREC enforces real estate license law and disciplines licensees.", unitReference: "2.4" },
  { questionText: "A sales associate applicant must have:", options: ["Florida residency", "College degree", "Prior real estate experience", "A high school diploma or equivalent"], correctAnswer: "D", explanation: "Minimum requirements include age 18, Social Security number, and high school diploma or equivalent.", unitReference: "2.1" },
  { questionText: "Nonresident applicants must:", options: ["Become residents within 90 days", "Complete additional coursework", "Sign the irrevocable consent to service of process", "Pass a state exam twice"], correctAnswer: "C", explanation: "This allows DBPR to accept legal service on behalf of the nonresident.", unitReference: "2.1" },
  { questionText: "Performing real estate services for compensation without a license is a:", options: ["Second‑degree misdemeanor", "First‑degree misdemeanor", "Third‑degree felony", "Civil offense only"], correctAnswer: "C", explanation: "Florida law classifies unlicensed compensated activity as a felony.", unitReference: "5.1" },
  { questionText: "Who is exempt from real estate licensure?", options: ["Apartment leasing agents", "Paid referral agents", "Property managers earning commission", "Attorney‑in‑fact acting under a power of attorney"], correctAnswer: "D", explanation: "A POA allows a person to act for another in a single transaction without a license.", unitReference: "2.1" },
  { questionText: "A license becomes involuntary inactive when the licensee:", options: ["Is suspended by FREC", "Chooses to stop practicing", "Fails to renew before expiration", "Passes the broker exam"], correctAnswer: "C", explanation: "Failure to renew results in automatic involuntary inactive status.", unitReference: "2.5" },
  { questionText: "Failure to complete post‑licensing education before the first renewal causes the license to:", options: ["Become suspended", "Require extra CE", "Become null and void", "Convert to voluntary inactive"], correctAnswer: "C", explanation: "Post‑licensing is mandatory; failure voids the license.", unitReference: "2.6" },
  { questionText: "A license that has been involuntary inactive for more than 2 years becomes:", options: ["Suspended", "Probationary", "Revoked", "Null and void"], correctAnswer: "D", explanation: "Such a license cannot be reinstated.", unitReference: "2.5" },
  { questionText: "FREC members are appointed by:", options: ["DBPR", "County governments", "The Florida Supreme Court", "The Governor, and confirmed by the Senate"], correctAnswer: "D", explanation: "Appointment procedures are set by Florida statute.", unitReference: "2.4" },
  { questionText: "Transaction brokers owe which duty?", options: ["Full confidentiality", "Loyalty", "Limited confidentiality", "Fiduciary duty"], correctAnswer: "C", explanation: "Transaction brokerage offers limited representation, not full fiduciary duties.", unitReference: "4.3" },
  { questionText: "The Single Agent Notice must be given in writing for:", options: ["All leases", "Commercial property only", "Residential single‑agency representation", "No brokerage relationships"], correctAnswer: "C", explanation: "Written disclosure is required before entering a residential single‑agency relationship.", unitReference: "4.1" },
  { questionText: "The No Brokerage Relationship Notice must be provided:", options: ["At closing", "Before advertising", "After showing property", "Before showing property or entering a listing agreement"], correctAnswer: "D", explanation: "Disclosure must precede providing real estate services.", unitReference: "4.2" },
  { questionText: "Accounting for all funds refers to:", options: ["Obedience", "Loyalty", "Proper management of escrow and trust monies", "Confidentiality"], correctAnswer: "C", explanation: "Brokers must maintain accurate and lawful control of client funds.", unitReference: "4.5" },
  { questionText: "A broker may transition from single agency to transaction brokerage only if:", options: ["Parties verbally agree", "FREC authorizes the switch", "No disclosure is needed", "The seller signs the Consent to Transition Notice"], correctAnswer: "D", explanation: "Written informed consent is required before transitioning.", unitReference: "4.4" },
  { questionText: "A broker must notify FREC of conflicting escrow demands within:", options: ["3 days", "10 business days", "15 days", "30 days"], correctAnswer: "B", explanation: "Notification must occur within 10 business days of receiving conflicting demands.", unitReference: "4.6" },
  { questionText: "Commingling occurs when a broker:", options: ["Uses two escrow accounts", "Holds checks overnight", "Mixes personal funds with escrow funds", "Uses an out‑of‑state bank"], correctAnswer: "C", explanation: "Personal funds may only be deposited in nominal amounts to maintain the account.", unitReference: "4.6" },
  { questionText: "Conversion is defined as:", options: ["Misfiling escrow records", "Commingling funds", "Using escrow funds for unauthorized purposes", "Banking errors"], correctAnswer: "C", explanation: "Conversion is the misuse of trust funds and is a serious violation.", unitReference: "5.1" },
  { questionText: "A sales associate receiving an earnest money deposit at 4 PM Wednesday must deliver it to the broker by:", options: ["Wednesday", "Thursday (next business day)", "Friday", "Monday"], correctAnswer: "B", explanation: "Associates must deliver deposits to their broker no later than the next business day.", unitReference: "4.6" },
  { questionText: "A broker's escrow account may be held in:", options: ["A foreign bank", "Any U.S. bank", "A title company only", "A Florida bank, credit union, or savings association"], correctAnswer: "D", explanation: "Escrow accounts must be in a Florida‑based financial institution.", unitReference: "4.6" },
  { questionText: "Failure to maintain required business records violates:", options: ["Civil rights laws", "Environmental laws", "Recordkeeping requirements", "Antitrust laws"], correctAnswer: "C", explanation: "Brokers must maintain records for at least five years.", unitReference: "4.7" },
  { questionText: "When a sales associate leaves a brokerage, who owns the listings?", options: ["The associate", "The buyer", "The MLS", "The broker"], correctAnswer: "D", explanation: "All listings and files belong to the employing broker.", unitReference: "4.1" },
  { questionText: "Which advertisement complies with Florida law?", options: ["Call Mike!", "Homes by Julie", "Sunset Realty — Call Mike", "Your Favorite Agent—Julie"], correctAnswer: "C", explanation: "Advertisements must clearly display the registered brokerage name.", unitReference: "4.8" },
  { questionText: "An escrow dispute occurs when:", options: ["A deposit is late", "The seller cancels a listing", "Parties disagree over entitlement to escrow funds", "The check bounces"], correctAnswer: "C", explanation: "An escrow dispute arises when conflicting demands are made for the same funds.", unitReference: "4.6" },
  { questionText: "Mediation of an escrow dispute requires:", options: ["No agreement", "FREC approval", "Written consent from both parties", "A court order"], correctAnswer: "C", explanation: "Mediation is voluntary and requires written agreement from all parties.", unitReference: "4.6" },
  { questionText: "A broker must institute an escrow dispute settlement procedure within:", options: ["10 business days", "15 business days", "30 days", "45 days"], correctAnswer: "B", explanation: "Florida law requires brokers to begin a settlement procedure within 15 business days after receiving conflicting demands for escrow funds.", unitReference: "4.6" },
  { questionText: "Misrepresentation is:", options: ["An unintentional mistake", "A false statement of material fact", "Failure to disclose a minor defect", "A breach of contract"], correctAnswer: "B", explanation: "Misrepresentation occurs when a licensee provides false material information that affects a party's decision.", unitReference: "5.2" },
  { questionText: "Concealment occurs when a licensee:", options: ["Provides too much information", "Makes a math error", "Intentionally withholds material facts", "Discloses confidential information"], correctAnswer: "C", explanation: "Concealment is purposeful nondisclosure of information that a reasonable person would want to know.", unitReference: "5.2" },
  { questionText: "Culpable negligence is:", options: ["Intentional fraud", "A simple oversight", "Reckless disregard for consequences", "A clerical error"], correctAnswer: "C", explanation: "Culpable negligence means carelessness showing a disregard for the safety or rights of others.", unitReference: "5.3" },
  { questionText: "Administrative fines for real estate violations are imposed by:", options: ["DBPR", "Legislature", "Courts", "FREC"], correctAnswer: "D", explanation: "The Florida Real Estate Commission may impose fines up to $5,000 per violation.", unitReference: "5.4" },
  { questionText: "Real property includes:", options: ["Movable items", "Land and anything permanently attached to it", "Trade fixtures", "Personal belongings"], correctAnswer: "B", explanation: "Real property is land, improvements, and associated legal rights.", unitReference: "8.1" },
  { questionText: "Which of the following is considered a fixture?", options: ["Movable dishwasher", "Patio furniture", "Free‑standing stove", "Built‑in microwave"], correctAnswer: "D", explanation: "Fixtures are items permanently affixed to real property.", unitReference: "8.1" },
  { questionText: "Which co‑ownership is exclusive to married couples?", options: ["Joint tenancy", "Tenancy in common", "Tenancy at will", "Tenancy by the entireties"], correctAnswer: "D", explanation: "This form includes survivorship and creditor protection unique to spouses.", unitReference: "8.2" },
  { questionText: "The right of survivorship belongs to which form of ownership?", options: ["Tenancy at sufferance", "Joint tenancy", "Tenancy in common", "Life estate"], correctAnswer: "B", explanation: "Upon death, the deceased's interest transfers automatically to surviving owners.", unitReference: "8.2" },
  { questionText: "The deed that provides the most protection to the grantee is the:", options: ["Bargain and sale deed", "Quitclaim deed", "Special warranty deed", "General warranty deed"], correctAnswer: "D", explanation: "Offers the strongest guarantees, including all covenants of title.", unitReference: "9.2" },
  { questionText: "Recording a deed gives the public:", options: ["Actual notice", "Witness acknowledgment", "Deed validity", "Constructive notice"], correctAnswer: "D", explanation: "Constructive notice occurs when information is made public through recording.", unitReference: "9.3" },
  { questionText: "A metes‑and‑bounds description must begin and end at the:", options: ["Monument", "Benchmark", "Range line", "Point of beginning (POB)"], correctAnswer: "D", explanation: "A legal description must close by returning to the POB.", unitReference: "9.1" },
  { questionText: "A township contains how many sections?", options: ["18", "24", "36", "48"], correctAnswer: "C", explanation: "A township is 6 miles by 6 miles = 36 one‑mile sections.", unitReference: "9.1" },
  { questionText: "The habendum clause in a deed:", options: ["Lists encumbrances", "Names grantor", "States consideration", "Defines the type of estate being conveyed"], correctAnswer: "D", explanation: "The 'to have and to hold' clause explains ownership rights granted.", unitReference: "9.2" },
  { questionText: "Title insurance protects against:", options: ["Future zoning changes", "Low appraisals", "Past title defects unknown at closing", "Structural damage"], correctAnswer: "C", explanation: "Coverage protects the insured from defects existing before policy issuance.", unitReference: "9.4" },
  { questionText: "Market value is defined as:", options: ["Highest possible price", "Assessed value", "Most probable price in a competitive market", "Investor's expected return"], correctAnswer: "C", explanation: "Market value assumes informed parties and reasonable exposure.", unitReference: "10.1" },
  { questionText: "The principle stating that buyers will not pay more than for an equally desirable substitute is:", options: ["Increasing returns", "Conformity", "Competition", "Substitution"], correctAnswer: "D", explanation: "Substitution is the foundation of the sales comparison approach.", unitReference: "10.2" },
  { questionText: "The cost‑depreciation method is most appropriate for:", options: ["Resale homes", "Apartment complexes", "Vacant land", "Special‑purpose properties"], correctAnswer: "D", explanation: "Churches, schools, and govt buildings lack comparables; cost approach works best.", unitReference: "10.3" },
  { questionText: "Physical deterioration refers to:", options: ["Faulty floor plan", "Location issues", "Normal wear and tear", "External neighborhood decline"], correctAnswer: "C", explanation: "Physical deterioration is the loss of value due to age and wear.", unitReference: "10.4" },
  { questionText: "Functional obsolescence is caused by:", options: ["Peeling paint", "Outdated or undesirable design", "Economic decline", "Weather damage"], correctAnswer: "B", explanation: "Examples: small rooms, poor layout, outdated fixtures.", unitReference: "10.4" },
  { questionText: "External (economic) obsolescence results from:", options: ["Deferred maintenance", "Over‑improvement", "Neighborhood or external factors", "Poor design"], correctAnswer: "C", explanation: "Examples: nearby factory, airport noise, zoning changes.", unitReference: "10.4" },
  { questionText: "GRM is used primarily for:", options: ["Commercial property", "Industrial property", "1–4 unit residential income property", "Special‑purpose buildings"], correctAnswer: "C", explanation: "GRM uses monthly or annual gross rent to estimate value.", unitReference: "10.5" },
  { questionText: "A comparable sells for $350,000. The subject has a pool worth $20,000, but the comp does not. Adjusted comp value?", options: ["$330,000", "$350,000", "$370,000", "$390,000"], correctAnswer: "A", explanation: "Adjust the comparable downward when it is inferior to the subject.", unitReference: "10.6" },
  { questionText: "A contract lacking consideration is:", options: ["Void", "Voidable", "Enforceable", "Bilateral"], correctAnswer: "A", explanation: "Consideration is required for a valid contract.", unitReference: "11.1" },
  { questionText: "A contract created by the actions of the parties is:", options: ["Express", "Implied", "Executory", "Unenforceable"], correctAnswer: "B", explanation: "Conduct, not words, forms the agreement.", unitReference: "11.2" },
  { questionText: "A unilateral contract is one in which:", options: ["Both parties promise to perform", "Neither must perform", "Contract is voidable", "Only one party is obligated"], correctAnswer: "D", explanation: "Example: option contracts—only the seller is bound.", unitReference: "11.2" },
  { questionText: "The Statute of Frauds requires certain contracts to be:", options: ["Recorded", "Oral", "In writing", "Notarized"], correctAnswer: "C", explanation: "Real estate contracts longer than one year must be written.", unitReference: "11.3" },
  { questionText: "The Statute of Limitations concerns:", options: ["Contract content", "Time allowed to sue", "Required signatures", "Contract format"], correctAnswer: "B", explanation: "Sets the deadline for bringing legal action.", unitReference: "11.4" },
  { questionText: "An option contract is:", options: ["A bilateral contract", "A lease", "A unilateral contract", "A novation"], correctAnswer: "C", explanation: "Buyer has the right, but not obligation, to buy.", unitReference: "11.2" },
  { questionText: "Earnest money is:", options: ["Legally required", "A commission advance", "A good‑faith deposit", "Paid only by sellers"], correctAnswer: "C", explanation: "Shows buyer's intention to complete the purchase.", unitReference: "4.6" },
  { questionText: "Liquidated damages typically refer to:", options: ["Seller paying buyer fees", "Seller keeping earnest money if buyer defaults", "Rescission", "Arbitration"], correctAnswer: "B", explanation: "Pre-agreed damages in case of breach.", unitReference: "11.5" },
  { questionText: "A mortgage is best described as:", options: ["The actual loan", "Title to property", "A lien securing a debt", "A conveyance"], correctAnswer: "C", explanation: "The mortgage creates a security interest in the property.", unitReference: "12.1" },
  { questionText: "The promissory note is:", options: ["A lien", "A deed", "A mortgage", "The borrower's written promise to repay"], correctAnswer: "D", explanation: "The note evidences the debt.", unitReference: "12.1" },
  { questionText: "FHA loans are:", options: ["Guaranteed", "Insured", "Non‑recourse", "Lender‑funded"], correctAnswer: "B", explanation: "FHA is an insurer, not a lender.", unitReference: "12.3" },
  { questionText: "VA loans are:", options: ["Insured", "Guaranteed", "Private loans only", "Balloon loans"], correctAnswer: "B", explanation: "VA guarantees loans made by approved lenders.", unitReference: "12.3" },
  { questionText: "Equity in a property is:", options: ["The assessed value", "The owner's value after subtracting debt", "The down payment", "The purchase price"], correctAnswer: "B", explanation: "Equity represents the portion of the property's value the owner truly owns: Equity = Market Value − Loan Balance.", unitReference: "12.2" },
  { questionText: "A lender's yield increases when:", options: ["PMI is removed", "The interest rate decreases", "Discount points are paid", "The loan is prepaid early"], correctAnswer: "C", explanation: "Each discount point (1% of the loan amount) raises lender yield by about 1/8 of 1%, increasing effective return.", unitReference: "12.2" },
  { questionText: "A deed in lieu of foreclosure is:", options: ["A short sale", "A voluntary transfer of title from borrower to lender", "A deficiency judgment", "An auction sale"], correctAnswer: "B", explanation: "The borrower deeds property back to the lender to avoid the foreclosure process.", unitReference: "12.4" },
  { questionText: "Truth in Lending (Regulation Z) requires disclosure of:", options: ["Appraised value", "Closing costs", "Finance charges only", "Annual Percentage Rate (APR)"], correctAnswer: "D", explanation: "APR allows consumers to compare loans accurately, reflecting cost of credit including fees.", unitReference: "14.3" },
  { questionText: "RESPA prohibits:", options: ["Steering", "Redlining", "Blockbusting", "Kickbacks or referral fees for settlement services"], correctAnswer: "D", explanation: "Section 8 of RESPA bans unearned fees, kickbacks, and referral payments, protecting consumers.", unitReference: "14.2" },
  { questionText: "Which is NOT a protected class under the Fair Housing Act?", options: ["Race", "National origin", "Religion", "Occupation"], correctAnswer: "D", explanation: "Federal law protects race, color, religion, sex, national origin, disability, and familial status. Occupation is not included.", unitReference: "14.1" },
  { questionText: "Steering occurs when a licensee:", options: ["Creates panic selling", "Reduces loan approvals", "Denies financing to neighborhoods", "Directs buyers toward or away from certain areas"], correctAnswer: "D", explanation: "Steering limits buyer choice and is a serious fair housing violation.", unitReference: "14.1" },
  { questionText: "The ADA primarily applies to:", options: ["Residential dwellings", "Farm land", "Public accommodations and commercial facilities", "Private homeowners"], correctAnswer: "C", explanation: "ADA requires accessibility in public and commercial properties (ramps, parking, restrooms, etc.).", unitReference: "14.4" },
  { questionText: "The purpose of zoning is to:", options: ["Set property taxes", "Regulate and control land use", "Determine interest rates", "Mandate construction materials"], correctAnswer: "B", explanation: "Zoning divides land into districts (e.g., residential, commercial, industrial) to guide development.", unitReference: "13.1" },
  { questionText: "A nonconforming use is:", options: ["Illegal use", "A variance", "A use that was legal before new zoning rules and is allowed to continue", "Rezoning"], correctAnswer: "C", explanation: "This is a 'grandfathered' use that existed before zoning changed.", unitReference: "13.1" },
  { questionText: "A variance allows:", options: ["Prohibited use", "Commercial use in residential zones", "Nonconforming use", "A deviation from dimensional zoning requirements"], correctAnswer: "D", explanation: "Variances allow relief from setbacks, height limits, lot size, etc., when strict enforcement is unfair.", unitReference: "13.1" },
  { questionText: "A special exception (conditional use) is:", options: ["A variance", "A use permitted if conditions are met", "A nonconforming use", "A zoning violation"], correctAnswer: "B", explanation: "Common examples: churches, schools, daycares in residential zones.", unitReference: "13.1" },
  { questionText: "Save Our Homes limits annual increases in assessed value to:", options: ["1%", "3% or the CPI, whichever is lower", "5%", "10%"], correctAnswer: "B", explanation: "Florida's SOH cap reduces property tax increases for homesteaded properties.", unitReference: "13.3" },
  { questionText: "The Florida homestead exemption is:", options: ["$10,000", "$25,000", "$50,000", "$75,000"], correctAnswer: "C", explanation: "Homeowners can exempt up to $50,000 from property tax assessment.", unitReference: "13.3" },
  { questionText: "Ad valorem taxes are based on:", options: ["Income", "Sales", "Property value", "Number of rooms"], correctAnswer: "C", explanation: "Property taxes are calculated as a percentage of assessed value.", unitReference: "13.2" },
  { questionText: "A mill is equal to:", options: ["$1 per $100", "$10 per $1,000", "$1 per $1,000", "$100 per $1,000"], correctAnswer: "C", explanation: "One mill = 1/10 of a cent = $1 per $1,000 of taxable value.", unitReference: "13.2" },
  { questionText: "A broker may pay a referral fee to:", options: ["An unlicensed neighbor", "A tenant", "A clerical employee", "A licensed out‑of‑state broker or sales associate"], correctAnswer: "D", explanation: "Referral fees may only be paid to licensed individuals.", unitReference: "4.9" },
  { questionText: "A tenant who stays beyond the lease term without the landlord's consent is a:", options: ["Tenant at will", "Periodic tenant", "Tenant for years", "Tenant at sufferance"], correctAnswer: "D", explanation: "Tenancy at sufferance occurs when someone holds over without permission.", unitReference: "15.1" },
  { questionText: "A percentage lease is most commonly used in:", options: ["Office buildings", "Retail properties", "Industrial warehouses", "Residential apartments"], correctAnswer: "B", explanation: "Retail tenants often pay base rent plus a percentage of sales.", unitReference: "15.1" },
  { questionText: "Under a gross lease, the tenant pays:", options: ["Base rent plus all operating expenses", "Only utilities", "A fixed rent with landlord paying operating expenses", "A percentage of sales"], correctAnswer: "C", explanation: "Landlord covers taxes, insurance, and maintenance.", unitReference: "15.1" },
  { questionText: "A net lease requires the tenant to pay:", options: ["Only rent", "Rent plus some or all operating expenses", "A percentage of sales", "Nothing"], correctAnswer: "B", explanation: "Tenant shares in property expenses beyond base rent.", unitReference: "15.1" },
  { questionText: "A landlord must return a security deposit within:", options: ["7 days", "15 days if not making a claim", "21 days", "45 days regardless"], correctAnswer: "B", explanation: "Florida law: 15 days to return deposit if no claim is made; 30 days to notify tenant of claim.", unitReference: "15.2" },
  { questionText: "Prorations at closing divide:", options: ["Commission", "Prepaid or accrued expenses", "Attorney fees", "Recording fees"], correctAnswer: "B", explanation: "Items like taxes and insurance are divided based on date of closing.", unitReference: "14.4" },
  { questionText: "The Closing Disclosure must be provided:", options: ["At closing", "3 business days before closing", "7 days before closing", "When the buyer applies for a loan"], correctAnswer: "B", explanation: "TRID rules require 3 business days before closing for review.", unitReference: "14.3" },
  { questionText: "Which document transfers title from seller to buyer?", options: ["Mortgage", "Promissory note", "Deed", "Listing agreement"], correctAnswer: "C", explanation: "The deed is the legal document conveying ownership.", unitReference: "9.2" },
  { questionText: "An abstract of title is:", options: ["A summary of all recorded documents affecting title", "Title insurance", "A survey", "A deed"], correctAnswer: "A", explanation: "It provides a historical summary of title records.", unitReference: "9.4" },
];

// Form B questions (100 questions from the alternate final exam document)
const formBQuestions = [
  { questionText: "Which activity requires a Florida real estate license?", options: ["Paying a referral bonus for a lead", "Advertising a friend's home for free", "Negotiating rental terms for another for compensation", "Selling your own home without a broker"], correctAnswer: "C", explanation: "Performing real estate services for another and for compensation requires licensure.", unitReference: "2.1" },
  { questionText: "A broker who helps a property owner determine market rent is performing:", options: ["Valuation", "Property management", "Development planning", "Residential marketing"], correctAnswer: "B", explanation: "Property managers handle market rent analysis, budgeting, and operations.", unitReference: "1.3" },
  { questionText: "A sales associate who specializes in condominium resales is working in which field?", options: ["Business brokerage", "Industrial", "Residential real estate", "Agricultural"], correctAnswer: "C", explanation: "Condominiums and single‑family dwellings fall under residential practice.", unitReference: "1.2" },
  { questionText: "Which professional provides valuation services without advocating for either party?", options: ["Mortgage broker", "Property manager", "Appraiser", "Home inspector"], correctAnswer: "C", explanation: "Appraisers provide impartial opinions of value following USPAP.", unitReference: "1.1" },
  { questionText: "Which organization administers and enforces Chapter 475, F.S.?", options: ["DBPR", "FAR", "CFPB", "FREC"], correctAnswer: "D", explanation: "The Florida Real Estate Commission enforces license law and disciplines licensees.", unitReference: "2.4" },
  { questionText: "To obtain a Florida sales associate license, an applicant must:", options: ["Have Florida residency", "Pass a background interview", "Complete 48 hours of pre‑licensing education", "Hold a high school diploma or equivalent"], correctAnswer: "D", explanation: "Minimum requirements include age 18, SSN, diploma/equivalent, and completing the 63‑hour pre‑license course.", unitReference: "2.1" },
  { questionText: "A licensee who fails to renew before expiration and continues practicing is guilty of:", options: ["Misrepresentation", "Unlicensed activity", "Incompetence", "Culpable negligence"], correctAnswer: "B", explanation: "Practicing past expiration is considered unlicensed activity.", unitReference: "5.1" },
  { questionText: "A licensee who voluntarily chooses not to practice may place their license in:", options: ["Involuntary inactive", "Suspended", "Voluntary inactive", "Probationary"], correctAnswer: "C", explanation: "Licensees may opt for voluntary inactive status by request.", unitReference: "2.5" },
  { questionText: "Which brokerage relationship imposes fiduciary duties?", options: ["No brokerage", "Transaction brokerage", "Single agency", "Dual agency"], correctAnswer: "C", explanation: "Fiduciary duties apply only in single‑agency relationships.", unitReference: "4.1" },
  { questionText: "A single agent owes which duty to the principal?", options: ["Limited confidentiality", "Accountability only", "Loyalty", "No representation"], correctAnswer: "C", explanation: "Loyalty is a fiduciary duty owed exclusively by single agents.", unitReference: "4.1" },
  { questionText: "A transaction broker represents:", options: ["The seller only", "The buyer only", "Both parties in a limited capacity", "Neither party"], correctAnswer: "C", explanation: "The relationship provides limited representation without fiduciary duties.", unitReference: "4.3" },
  { questionText: "The No Brokerage Relationship Notice must be given:", options: ["At closing", "Before showing property", "After obtaining signatures", "Only if the customer asks"], correctAnswer: "B", explanation: "Required before providing real estate services.", unitReference: "4.2" },
  { questionText: "A sales associate may accept compensation from:", options: ["A seller directly", "A mortgage lender", "A cooperating broker", "Their employing broker only"], correctAnswer: "D", explanation: "All compensation must flow through the broker.", unitReference: "4.9" },
  { questionText: "Blind advertising is illegal because it fails to include:", options: ["Agent phone number", "Office address", "Asking price", "Registered brokerage name"], correctAnswer: "D", explanation: "Florida law requires the brokerage name in all ads.", unitReference: "4.8" },
  { questionText: "A broker must deposit earnest money received from an associate no later than:", options: ["The same day", "The third business day after the associate received it", "The next Monday", "The fifth business day"], correctAnswer: "B", explanation: "Associate → broker: next business day; broker → escrow: by third business day.", unitReference: "4.6" },
  { questionText: "Commingling occurs when a broker:", options: ["Uses a non‑Florida bank", "Holds funds temporarily", "Mixes personal funds with escrow funds", "Earns interest on escrow"], correctAnswer: "C", explanation: "Only minimal personal funds may be placed in escrow accounts.", unitReference: "4.6" },
  { questionText: "Conversion is:", options: ["A bank error", "Failure to disclose", "Advertising improperly", "Unauthorized use of escrow funds"], correctAnswer: "D", explanation: "Conversion is a serious violation involving misuse of entrusted funds.", unitReference: "5.1" },
  { questionText: "If a broker receives conflicting demands for escrow funds, they must notify FREC within:", options: ["3 days", "5 days", "10 business days", "30 days"], correctAnswer: "C", explanation: "Florida law mandates written notice within 10 business days.", unitReference: "4.6" },
  { questionText: "A subdivision developer who sells lots and offers financing must register under which law?", options: ["RESPA", "TILA", "ILSA (Interstate Land Sales Full Disclosure Act)", "ADA"], correctAnswer: "C", explanation: "ILSA applies to interstate marketing of subdivided land of 25+ lots.", unitReference: "14.5" },
  { questionText: "A tenancy by the entireties includes which characteristic?", options: ["Equal shares for all parties", "Survivorship not included", "Individual creditors may attach either spouse's interest", "Unity of marriage and survivorship rights"], correctAnswer: "D", explanation: "This form is exclusive to married couples and includes survivorship.", unitReference: "8.2" },
  { questionText: "A quitclaim deed is often used to:", options: ["Convey warranties", "Secure mortgage liens", "Clear clouds on title", "Guarantee good title"], correctAnswer: "C", explanation: "Quitclaim deeds offer no warranties and are used to cure defects in title.", unitReference: "9.2" },
  { questionText: "The survey method that uses monuments, directions, and distances is:", options: ["Lot and block", "Government survey", "Metes and bounds", "Rectangular grid"], correctAnswer: "C", explanation: "The oldest method, defined by a point of beginning and perimeter bearings.", unitReference: "9.1" },
  { questionText: "Which appraisal approach is best for estimating the value of vacant land?", options: ["Income approach", "Sales comparison approach", "Cost‑depreciation", "Capitalization"], correctAnswer: "B", explanation: "Land is typically valued using sales comparables.", unitReference: "10.3" },
  { questionText: "Functional obsolescence relates to:", options: ["Neighborhood decline", "Construction defects", "Design flaws or outdated features", "Weather‑related deterioration"], correctAnswer: "C", explanation: "Caused by poor layout, outdated fixtures, or inadequate design.", unitReference: "10.4" },
  { questionText: "A bilateral contract is one in which:", options: ["Only one party is obligated", "Neither party must perform", "Terms are implied, not expressed", "Both parties make binding promises"], correctAnswer: "D", explanation: "Most real estate contracts are bilateral (e.g., purchase and sale agreements).", unitReference: "11.2" },
  { questionText: "A contract that has been fully performed by all parties is described as:", options: ["Void", "Voidable", "Executory", "Executed"], correctAnswer: "D", explanation: "An executed contract is one in which all duties have been completed. An executory contract still has performance remaining.", unitReference: "11.1" },
  { questionText: "The legal description 'Lot 12, Block B, Lakeside Estates' is an example of:", options: ["Metes and bounds", "Government survey", "Lot and block system", "Benchmarking"], correctAnswer: "C", explanation: "Subdivision plats use the lot and block method tied to a recorded plat map.", unitReference: "9.1" },
  { questionText: "A deed must be signed by the grantor and:", options: ["The grantee", "Two witnesses", "The title company", "A notary"], correctAnswer: "B", explanation: "Florida requires two witnesses for the grantor's signature on a deed. Notarization is recommended but not required for validity.", unitReference: "9.2" },
  { questionText: "Which type of estate includes the right of survivorship?", options: ["Tenancy in common", "Tenancy at will", "Life estate", "Joint tenancy"], correctAnswer: "D", explanation: "In joint tenancy, the deceased owner's interest passes automatically to surviving owners.", unitReference: "8.2" },
  { questionText: "A buyer pays $8,000 in discount points on a $200,000 loan. How many points were charged?", options: ["2%", "3%", "4%", "6%"], correctAnswer: "C", explanation: "1 point = 1% of the loan amount. $8,000 ÷ $200,000 = 0.04 = 4 points.", unitReference: "12.2" },
  { questionText: "A mortgage clause that prevents the borrower from selling without lender approval is a:", options: ["Defeasance clause", "Due‑on‑sale clause", "Acceleration clause", "Prepayment penalty"], correctAnswer: "B", explanation: "Due‑on‑sale requires full repayment if the property is sold, protecting the lender from below‑market assumptions.", unitReference: "12.1" },
  { questionText: "The income approach to value is most appropriate for:", options: ["Vacant land", "Single‑family homes", "Apartment buildings", "Special‑purpose buildings"], correctAnswer: "C", explanation: "Income‑producing properties are best valued by converting income to value.", unitReference: "10.5" },
  { questionText: "Which principle states that property value is enhanced when surrounding properties are similar?", options: ["Change", "Substitution", "Conformity", "Regression"], correctAnswer: "C", explanation: "Conformity supports higher value through consistent land use and property characteristics.", unitReference: "10.2" },
  { questionText: "A buyer gives the seller consideration in exchange for the right to purchase the property later. This agreement is a:", options: ["Bilateral contract", "Listing agreement", "Sales contract", "Option contract"], correctAnswer: "D", explanation: "An option is unilateral—the seller must sell if exercised, but the buyer is not obligated.", unitReference: "11.2" },
  { questionText: "A house with peeling paint and worn flooring is suffering from:", options: ["Functional obsolescence", "Economic obsolescence", "Physical deterioration", "External depreciation"], correctAnswer: "C", explanation: "Physical deterioration = normal wear and tear requiring repair.", unitReference: "10.4" },
  { questionText: "A borrower's monthly payment includes principal, interest, taxes, and insurance. This is a:", options: ["Growing equity mortgage", "ARM", "Interest‑only loan", "PITI payment"], correctAnswer: "D", explanation: "PITI = Principal + Interest + Taxes + Insurance.", unitReference: "12.1" },
  { questionText: "A licensee who forgets to include a required disclosure has committed:", options: ["Fraud", "Culpable negligence", "Conspiracy", "Misrepresentation"], correctAnswer: "B", explanation: "Culpable negligence = careless or reckless action, even without intent.", unitReference: "5.3" },
  { questionText: "A landlord must return a security deposit within:", options: ["7 days", "15 days if not making a claim", "21 days", "45 days regardless"], correctAnswer: "B", explanation: "Florida law: 15 days to return deposit if no claim is made; 30 days to notify tenant of claim.", unitReference: "15.2" },
  { questionText: "A tenant remains on property after lease expiration without the landlord's consent. This tenancy is called:", options: ["Tenancy at will", "Periodic tenancy", "Tenancy for years", "Tenancy at sufferance"], correctAnswer: "D", explanation: "Tenant once had lawful possession but now remains without permission.", unitReference: "15.1" },
  { questionText: "A retail tenant paying a base rent plus a percentage of sales has which type of lease?", options: ["Gross lease", "Net lease", "Percentage lease", "Graduated lease"], correctAnswer: "C", explanation: "Common in commercial retail centers where rent rises with business volume.", unitReference: "15.1" },
  { questionText: "Under RESPA, unearned fees are:", options: ["Allowed if disclosed", "Allowed for marketing", "Prohibited kickbacks or referral fees", "Required for title services"], correctAnswer: "C", explanation: "RESPA Section 8 bans unearned fees and referral payments.", unitReference: "14.2" },
  { questionText: "Which advertisement complies with Florida law?", options: ["Call Sam — Best Agent in Town!", "SunCoast Realty — Call Sam", "Your Real Estate Expert — Sam", "Sam Sells Homes!"], correctAnswer: "B", explanation: "The brokerage name must appear prominently in all advertising.", unitReference: "4.8" },
  { questionText: "Which of the following is a protected class under the Fair Housing Act?", options: ["Smokers", "Familial status", "Occupation", "Students"], correctAnswer: "B", explanation: "Protected classes: race, color, religion, sex, national origin, disability, familial status.", unitReference: "14.1" },
  { questionText: "A licensee tells owners that minorities are moving into the neighborhood to encourage them to sell quickly. This is:", options: ["Steering", "Redlining", "Blockbusting", "Canvassing"], correctAnswer: "C", explanation: "Blockbusting is illegal inducement of panic selling through discriminatory statements.", unitReference: "14.1" },
  { questionText: "A variance is granted when:", options: ["Zoning must change", "A prohibited use is allowed", "Strict zoning compliance creates unnecessary hardship", "A use is incompatible with zoning"], correctAnswer: "C", explanation: "Variances allow exceptions to dimensional zoning rules (e.g., setbacks).", unitReference: "13.1" },
  { questionText: "A developer dedicates land for public use when filing a subdivision plat. This process is called:", options: ["Variance", "Zoning amendment", "Dedication", "Escheat"], correctAnswer: "C", explanation: "Dedication = transferring land for public streets, parks, or utilities.", unitReference: "9.4" },
  { questionText: "A house valued at $300,000 produces $24,000 NOI. What is the capitalization rate?", options: ["5%", "6%", "8%", "12%"], correctAnswer: "C", explanation: "Cap Rate = NOI ÷ Value = 24,000 ÷ 300,000 = 0.08 (8%).", unitReference: "10.5" },
  { questionText: "Economic (external) obsolescence is caused by:", options: ["Outdated floor plans", "Wear and tear", "Factors outside the property, such as nearby railroad or factory", "Over‑improvement"], correctAnswer: "C", explanation: "External factors reduce value regardless of property condition.", unitReference: "10.4" },
  { questionText: "A lender must provide a Loan Estimate within:", options: ["1 business day", "3 business days after loan application", "7 calendar days", "Before closing only"], correctAnswer: "B", explanation: "TILA‑RESPA rules require a Loan Estimate within three business days of application.", unitReference: "14.3" },
  { questionText: "Which is an example of a unilateral contract?", options: ["Exclusive‑right‑of‑sale listing", "Purchase and sale agreement", "Lease agreement", "Option contract"], correctAnswer: "D", explanation: "Only one party (the seller) is obligated; the buyer may choose whether to act.", unitReference: "11.2" },
  { questionText: "Which type of mortgage allows the lender to increase the interest rate at set intervals?", options: ["Fixed‑rate mortgage", "Package mortgage", "Blanket mortgage", "Adjustable‑rate mortgage (ARM)"], correctAnswer: "D", explanation: "ARMs adjust periodically based on an index, margin, and adjustment caps.", unitReference: "12.3" },
  { questionText: "A mortgage clause that releases some parcels as the loan is paid down is a:", options: ["Subordination clause", "Release clause", "Prepayment clause", "Due‑on‑sale clause"], correctAnswer: "B", explanation: "Release clauses are common in blanket mortgages on subdivisions; parcels are released as the developer pays.", unitReference: "12.1" },
  { questionText: "The economic characteristic of real estate stating land cannot be relocated is:", options: ["Immobility", "Indestructibility", "Situs", "Heterogeneity"], correctAnswer: "C", explanation: "Situs is the economic importance of location—buyers value where land is, not just the land itself.", unitReference: "8.1" },
  { questionText: "The market value of a property is best described as:", options: ["Highest possible price", "Insurance replacement cost", "Assessed value", "Most probable selling price in a competitive and open market"], correctAnswer: "D", explanation: "Market value assumes informed parties, no pressure, and reasonable exposure time.", unitReference: "10.1" },
  { questionText: "Which appraisal method subtracts depreciation from reproduction or replacement cost?", options: ["Income approach", "Sales comparison approach", "Cost‑depreciation approach", "Gross rent multiplier method"], correctAnswer: "C", explanation: "Cost approach = Cost of improvements − Depreciation + Land value.", unitReference: "10.3" },
  { questionText: "Which type of depreciation is generally incurable?", options: ["Physical deterioration (minor)", "External (economic) obsolescence", "Functional obsolescence (curable)", "Deferred maintenance"], correctAnswer: "B", explanation: "External obsolescence (e.g., nearby factory, noise) cannot be fixed by the owner.", unitReference: "10.4" },
  { questionText: "A property's Effective Gross Income (EGI) equals:", options: ["PGI + operating expenses", "NOI − expenses", "PGI − vacancy and collection losses", "NOI + debt service"], correctAnswer: "C", explanation: "PGI (Potential Gross Income) minus losses gives the actual income expected.", unitReference: "10.5" },
  { questionText: "Which is an example of a special‑purpose property?", options: ["Retail store", "Office building", "Warehouse", "Church or school"], correctAnswer: "D", explanation: "Special‑purpose properties often rely on the cost approach because comparable sales are limited.", unitReference: "10.3" },
  { questionText: "A tenant pays $18 per square foot plus property taxes, insurance, and maintenance. This lease is best described as:", options: ["Gross lease", "Percentage lease", "Graduated lease", "Net lease"], correctAnswer: "D", explanation: "Net leases shift certain operating expenses to the tenant.", unitReference: "15.1" },
  { questionText: "Which item must be prorated on a closing disclosure?", options: ["Title insurance premium", "Survey fee", "Property taxes", "Loan origination fee"], correctAnswer: "C", explanation: "Taxes are shared proportionately between buyer and seller based on the date of closing.", unitReference: "14.4" },
  { questionText: "A buyer receives title but the lender retains a lien. Florida recognizes this under:", options: ["Title theory", "Lien theory", "Ownership theory", "Mortgagee‑title doctrine"], correctAnswer: "B", explanation: "Florida is a lien theory state, meaning the mortgage creates a lien — not a title transfer.", unitReference: "12.1" },
  { questionText: "A broker who promises something they know is untrue is engaging in:", options: ["Culpable negligence", "Fraud", "Concealment only", "Puffing"], correctAnswer: "B", explanation: "Fraud = intentional deception for personal gain or to cause harm.", unitReference: "5.2" },
  { questionText: "A landlord who intends to impose a claim on a tenant's security deposit must notify the tenant within:", options: ["7 days", "15 days", "30 days", "45 days"], correctAnswer: "C", explanation: "The landlord has: 15 days to return deposit if no claim; 30 days to notify of claim.", unitReference: "15.2" },
  { questionText: "Redlining is a discriminatory practice carried out by:", options: ["Brokers", "Sellers", "Lenders or insurance companies", "Homeowners associations"], correctAnswer: "C", explanation: "Redlining = refusing loans/insurance in certain neighborhoods based on protected classes.", unitReference: "14.1" },
  { questionText: "When a tenant pays a fixed rent and the landlord pays all operating expenses, the lease is a:", options: ["Gross lease", "Net lease", "Percentage lease", "Variable lease"], correctAnswer: "A", explanation: "Common in office and residential leases.", unitReference: "15.1" },
  { questionText: "Which of the following creates a lien against the borrower's property?", options: ["Promissory note", "Mortgage", "Deed", "Satisfaction letter"], correctAnswer: "B", explanation: "The mortgage secures the debt evidenced by the promissory note.", unitReference: "12.1" },
  { questionText: "The purpose of the defeasance clause in a mortgage is to:", options: ["Trigger foreclosure", "Prevent resale", "Increase interest", "Require the lender to release the lien when debt is paid"], correctAnswer: "D", explanation: "Once paid in full, the lender must issue a satisfaction of mortgage.", unitReference: "12.1" },
  { questionText: "Which contract is NOT required to be in writing under the Statute of Frauds?", options: ["Lease for 3 years", "Sale of a commercial building", "Listing agreement for a house", "Lease for 10 months"], correctAnswer: "D", explanation: "Leases 1 year or less may be oral and still enforceable.", unitReference: "11.3" },
  { questionText: "A joint tenancy must include which characteristic?", options: ["Unequal interests", "No survivorship", "Unity of possession, interest, title, and time", "Married owners only"], correctAnswer: "C", explanation: "Joint tenancy requires the four unities and survivorship.", unitReference: "8.2" },
  { questionText: "A property's assessed value is $180,000, and the homeowner qualifies for the full $50,000 homestead exemption. What is the taxable value?", options: ["$130,000", "$130,000", "$150,000", "$180,000"], correctAnswer: "B", explanation: "Taxable value = Assessed value − Exemptions = 180,000 − 50,000 = 130,000.", unitReference: "13.3" },
  { questionText: "A developer requesting permission to build a daycare in a residential zone would seek a:", options: ["Variance", "Rezoning", "Special exception (conditional use)", "Nonconforming use"], correctAnswer: "C", explanation: "Certain uses are allowed if conditions are met, such as schools or churches in residential districts.", unitReference: "13.1" },
  { questionText: "What determines the time period during which a party may sue to enforce a contract?", options: ["Statute of Frauds", "Legal description", "Notarization", "Statute of Limitations"], correctAnswer: "D", explanation: "The Statute of Limitations sets deadlines for taking legal action.", unitReference: "11.4" },
  { questionText: "Which loan type is guaranteed by the federal government?", options: ["Conventional", "FHA", "VA", "Package mortgage"], correctAnswer: "C", explanation: "The VA guarantees loans made by approved lenders.", unitReference: "12.3" },
  { questionText: "The purpose of the Loan Estimate is to:", options: ["Replace the deed", "Provide marketing disclosures", "Finalize closing costs", "Help borrowers compare loan terms before committing"], correctAnswer: "D", explanation: "Required under TILA‑RESPA within 3 business days of application.", unitReference: "14.3" },
  { questionText: "Which party holds equitable title in a sales contract?", options: ["Broker", "Lender", "Seller", "Buyer"], correctAnswer: "D", explanation: "Once the contract is executed, the buyer holds equitable title, giving them the right to obtain ownership.", unitReference: "11.1" },
  { questionText: "Which of the following would be classified as real property?", options: ["A refrigerator", "Furniture", "Trade fixtures", "A built‑in wall cabinet"], correctAnswer: "D", explanation: "Real property includes fixtures—items permanently attached to the structure.", unitReference: "8.1" },
  { questionText: "Which characteristic of land refers to its permanence?", options: ["Situs", "Scarcity", "Indestructibility", "Heterogeneity"], correctAnswer: "C", explanation: "Land cannot be destroyed; it is considered indestructible.", unitReference: "8.1" },
  { questionText: "A deed that conveys title with only one warranty—the grantor has not encumbered the property—is a:", options: ["General warranty deed", "Quitclaim deed", "Special warranty deed", "Bargain and sale deed"], correctAnswer: "C", explanation: "Special warranty deeds limit the guarantee to the period of the grantor's ownership only.", unitReference: "9.2" },
  { questionText: "Which type of notice is provided when a document is recorded in the public records?", options: ["Actual notice", "Inquiry notice", "Personal notice", "Constructive notice"], correctAnswer: "D", explanation: "Recording puts the public 'on notice' of an interest in property.", unitReference: "9.3" },
  { questionText: "A borrower defaults and the lender forecloses. After the sale, there is still a balance owed. The lender may seek a:", options: ["Acceleration", "Subordination", "Deficiency judgment", "Satisfaction"], correctAnswer: "C", explanation: "If sale proceeds don't cover the debt, lender can pursue a deficiency judgment for the balance.", unitReference: "12.4" },
  { questionText: "Which FHA mortgage insurance premium is paid at closing?", options: ["Monthly MIP", "Upfront MIP (UFMIP)", "Private mortgage insurance", "Hazard insurance"], correctAnswer: "B", explanation: "UFMIP is paid at closing and is usually financed into the loan.", unitReference: "12.3" },
  { questionText: "A property manager's primary fiduciary duty is to:", options: ["The tenant", "The property owner", "The lender", "The HOA"], correctAnswer: "B", explanation: "The property manager acts as an agent for the owner.", unitReference: "1.3" },
  { questionText: "Title insurance differs from other insurance because it protects against:", options: ["Future events", "Past events", "Natural disasters", "Liability claims"], correctAnswer: "B", explanation: "Title insurance protects against defects that occurred before the policy was issued.", unitReference: "9.4" },
  { questionText: "An appraiser's opinion of value is found in the:", options: ["Abstract of title", "Appraisal report", "Survey", "Title commitment"], correctAnswer: "B", explanation: "The appraisal report contains the appraiser's conclusion of value.", unitReference: "10.1" },
  { questionText: "Which method of legal description relies on a recorded plat map?", options: ["Metes and bounds", "Government survey", "Lot and block", "Rectangular survey"], correctAnswer: "C", explanation: "The lot and block method references a recorded subdivision plat.", unitReference: "9.1" },
  { questionText: "The acceleration clause allows the lender to:", options: ["Increase the interest rate", "Demand full payment upon default", "Release the lien", "Subordinate the mortgage"], correctAnswer: "B", explanation: "Upon default, the lender can demand the entire loan balance be paid immediately.", unitReference: "12.1" },
  { questionText: "A buyer purchasing a home for $250,000 with a 20% down payment needs a loan for:", options: ["$50,000", "$100,000", "$150,000", "$200,000"], correctAnswer: "D", explanation: "20% of $250,000 = $50,000 down; loan needed = $250,000 - $50,000 = $200,000.", unitReference: "12.2" },
  { questionText: "Which deed offers no warranties whatsoever?", options: ["General warranty deed", "Special warranty deed", "Bargain and sale deed", "Quitclaim deed"], correctAnswer: "D", explanation: "Quitclaim deeds transfer whatever interest the grantor has, with no guarantees.", unitReference: "9.2" },
  { questionText: "FREC may NOT:", options: ["Impose fines", "Suspend licenses", "Determine commission rates", "Revoke licenses"], correctAnswer: "C", explanation: "Commission rates are negotiable between parties; FREC has no authority to set them.", unitReference: "2.4" },
  { questionText: "A broker's license may be suspended for:", options: ["Selling too many properties", "Having too many sales associates", "Violating Chapter 475", "Charging high commissions"], correctAnswer: "C", explanation: "Violations of license law can result in suspension or revocation.", unitReference: "5.4" },
  { questionText: "The bundle of legal rights includes all EXCEPT:", options: ["Right to sell", "Right to use", "Right to exclude", "Right to unlimited profits"], correctAnswer: "D", explanation: "The bundle includes possession, use, exclusion, enjoyment, and disposition—not unlimited profits.", unitReference: "8.1" },
  { questionText: "An easement appurtenant runs with the:", options: ["Owner", "Land", "Tenant", "Mortgage"], correctAnswer: "B", explanation: "Appurtenant easements transfer automatically when the property is sold.", unitReference: "8.3" },
  { questionText: "A property with an assessed value of $200,000 and a millage rate of 20 mills has an annual tax of:", options: ["$2,000", "$4,000", "$6,000", "$8,000"], correctAnswer: "B", explanation: "Tax = Assessed value × millage rate ÷ 1,000 = $200,000 × 20 ÷ 1,000 = $4,000.", unitReference: "13.2" },
  { questionText: "The process of converting income to value is called:", options: ["Depreciation", "Amortization", "Capitalization", "Appreciation"], correctAnswer: "C", explanation: "Capitalization is used in the income approach to appraisal.", unitReference: "10.5" },
  { questionText: "Which document is evidence of the debt in a real estate transaction?", options: ["Mortgage", "Deed", "Promissory note", "Title policy"], correctAnswer: "C", explanation: "The promissory note is the borrower's promise to repay the loan.", unitReference: "12.1" },
];

export async function importFinalExams(courseId: string) {
  console.log("Importing final exams for course:", courseId);
  
  // Check if Form A and Form B exams already exist
  const existingExams = await db.select().from(practiceExams)
    .where(and(
      eq(practiceExams.courseId, courseId),
      eq(practiceExams.isFinalExam, 1)
    ));
  
  // Delete existing final exams and their questions to start fresh
  for (const exam of existingExams) {
    await db.delete(examQuestions).where(eq(examQuestions.examId, exam.id));
    await db.delete(practiceExams).where(eq(practiceExams.id, exam.id));
    console.log(`Deleted existing exam: ${exam.title} (${exam.examForm || 'no form'})`);
  }
  
  // Create Form A exam
  const [formAExam] = await db.insert(practiceExams).values({
    courseId,
    title: "FREC I Final Exam - Form A",
    description: "100-question comprehensive final examination covering all course units. You must score 70% or higher to pass.",
    totalQuestions: 100,
    passingScore: 70,
    timeLimit: 180, // 3 hours
    isActive: 1,
    isFinalExam: 1,
    examForm: "A"
  }).returning();
  
  console.log("Created Form A exam:", formAExam.id);
  
  // Insert Form A questions
  for (let i = 0; i < formAQuestions.length; i++) {
    const q = formAQuestions[i];
    await db.insert(examQuestions).values({
      examId: formAExam.id,
      questionText: q.questionText,
      options: JSON.stringify(q.options),
      correctAnswer: q.correctAnswer,
      explanation: q.explanation,
      questionType: "multiple_choice",
      sequence: i,
      unitReference: q.unitReference
    });
  }
  
  console.log(`Inserted ${formAQuestions.length} questions for Form A`);
  
  // Create Form B exam
  const [formBExam] = await db.insert(practiceExams).values({
    courseId,
    title: "FREC I Final Exam - Form B",
    description: "Alternate 100-question comprehensive final examination covering all course units. You must score 70% or higher to pass.",
    totalQuestions: 100,
    passingScore: 70,
    timeLimit: 180, // 3 hours
    isActive: 1,
    isFinalExam: 1,
    examForm: "B"
  }).returning();
  
  console.log("Created Form B exam:", formBExam.id);
  
  // Insert Form B questions
  for (let i = 0; i < formBQuestions.length; i++) {
    const q = formBQuestions[i];
    await db.insert(examQuestions).values({
      examId: formBExam.id,
      questionText: q.questionText,
      options: JSON.stringify(q.options),
      correctAnswer: q.correctAnswer,
      explanation: q.explanation,
      questionType: "multiple_choice",
      sequence: i,
      unitReference: q.unitReference
    });
  }
  
  console.log(`Inserted ${formBQuestions.length} questions for Form B`);
  
  return { formAExam, formBExam };
}
